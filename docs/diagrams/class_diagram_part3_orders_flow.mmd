%% Class diagram â€” Part 3: Orders, Realtime & Flows
%% Generated: 2025-11-07
%% Purpose: show order lifecycles, realtime channels and interactions between student/restaurant flows

classDiagram

    class OrderLifecycle {
        + create() : pending
        + confirm() : confirmed
        + prepare() : preparing
        + ready() : ready
        + complete() : completed
        + cancel(reason) : cancelled
    }

    class RealtimeChannel {
        + subscribe()
        + onChange(callback)
        + unsubscribe()
    }

    class StudentTimeline {
        + viewActiveOrders()
        + viewHistory()
        + receiveRealtimeUpdate(order)
        + _studentId
    }

    class RestaurantTimeline {
        + viewPendingOrders()
        + confirmOrder(int orderId)
        + rejectOrder(int orderId, String reason)
        + markReady(int orderId)
    }

    %% Interactions
    SupabaseService ..> OrderLifecycle : "updateOrderStatus/cancelOrder"
    SupabaseService ..> RealtimeChannel : "setupOrdersRealtimeSubscription"

    RealtimeChannel <.. StudentTimeline : studentOrdersChannel
    RealtimeChannel <.. RestaurantTimeline : restaurantOrdersChannel

    StudentTimeline ..> SupabaseService : getStudentActiveOrders / getCompletedAndCancelledOrders
    RestaurantTimeline ..> SupabaseService : getRestaurantOrders / updateOrderStatus

    %% UI placement
    StudentTimeline --> HomeScreen : badgeNotifications
    RestaurantTimeline --> RestaurantDashboard : newOrderCard
